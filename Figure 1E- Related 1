####Fishers Test/Odds ratio comparing breast cancer risk gene sets with published YAP1 datasets

##Generic Intersect and Fishers Analysis
#Read in your gene lists and gene universe files, convert to genesymbol
#Your favorite gene list
YourFavGeneList <- read.table ("~/Desktop/RNAseq_Analyses/2021_11/2021_11_03/MEP/upGenes_DGEA_p0.05_Old_vs_Young_MEP.csv",
                               sep=",", header=TRUE)
YourFavGeneList <- YourFavGeneList[,1]
library(EnsDb.Hsapiens.v86)
YourFavGeneList_Symbol <- ensembldb::select(EnsDb.Hsapiens.v86, keys = as.vector(YourFavGeneList), keytype = "GENEID", columns = c("SYMBOL"))
YourFavGeneList_Symbol2 <- YourFavGeneList_Symbol$SYMBOL
write.table(YourFavGeneList_Symbol2, file="YourFavGeneList_genesymbol.csv", sep=",", row.names = FALSE,col.names = FALSE,quote = FALSE)

#Your Gene Universe
GeneUniverse <- read.table ("gene_universe_MEP.csv",
                            sep=",", header=TRUE)
GeneUniverse <- GeneUniverse[,1]
GeneUniverse_Symbol <- ensembldb::select(EnsDb.Hsapiens.v86, keys = as.vector(GeneUniverse), keytype = "GENEID", columns = c("SYMBOL"))
GeneUniverse_Symbol2 <- GeneUniverse_Symbol$SYMBOL
write.table(GeneUniverse_Symbol2, file="GeneUniverse_genesymbol.csv", sep=",", row.names = FALSE,col.names = FALSE)

#Assign variables for first gene list you are comparing
b <- read.table("~/Desktop/RNAseq_Analyses/Gene Lists of Interest/Cordenonsietal_2011_MCF10A_mousefibroblast_mouseliver_Yap.csv",
                sep=",", header=FALSE)
#Assign gene universe to variable a
a <- read.table("GeneUniverse_genesymbol.csv",
                sep=",", header=FALSE)
#Assign Your favorite genes to variable c
c <- read.table("YourFavGeneList_genesymbol.csv",
                sep=",", header=FALSE)

#invert data
a <- a [,1]
b <- b [,1]
c <- c [,1]
#intersect data
list1 <- intersect(a,b)
list2 <- intersect(b,c)
#Determine number of genes intersecting
la <- length(a)
lb <- length(b)
lc <- length(c)
ll1 <- length(list1)
ll2 <- length(list2)
ld <- la-lc

#Write list of genes that overlap
write.csv(list2,file="Intersect_MEP_Old_vs_Young_and_Cordenonsi_2011_YAP_Signature.csv",row.names = FALSE,quote=FALSE)

DEGenesInSet <- ll2
print(paste("No of DE Genes in Set is ",DEGenesInSet))

DEGenesNotInSet <- lc-ll2
print(paste("No of DE Genes Not in Set is ",DEGenesNotInSet))

nonDEGenesInSet <- ll1 - ll2
print(paste("No of non DE Genes in Set is ",nonDEGenesInSet))

nonDEGenesNotInSet <- ld- nonDEGenesInSet
print(paste("No of non DE Genes Not in Set is ",nonDEGenesNotInSet))


#Fishers test
#Make matrix
Data <- matrix(c(DEGenesInSet,DEGenesNotInSet,nonDEGenesInSet,nonDEGenesNotInSet),
               nrow = 2,
               dimnames = list(YAPgenes = c("In","Out"),
                               DEGenes = c("DEGenes","Non DE Genes")))
fisher.test(Data,alternative = "greater")











